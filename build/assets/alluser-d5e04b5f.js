import{r as c,j as e,h as Y,i as q,a as E,u as L,T as k,F as A,I as $,S as F,M as N,B as M,k as K,V as _,s as D,Q as f,l as H,H as J,n as G,o as Q}from"./index-dc75e3e3.js";const W=({totalpost:t,postperpage:S,changepageno:h,currentpage:r})=>{let m=[];const[l,j]=c.useState(5),[a,p]=c.useState(5),[u,d]=c.useState(0);for(let i=1;i<=Math.ceil(t/S);i++)m.push(i);const b=m.map((i,g)=>{if(i<a+1&&i>u)return e.jsx("span",{onClick:()=>h(i),className:r==i?"pages active":"pages",children:i},g)}),v=()=>{p(a+l),d(u+l),a>=m.length-1&&(p(m.length),d(m.length-l))},x=()=>{p(a-l),d(u-l),u<=1&&(p(l),d(0))};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Previous 5 Pages",onClick:x}),b,e.jsx(q,{title:"Next 5 Pages",onClick:v})]})},X=({inp:t,modal:S,setmodal:h,handler:r,fetche:m})=>{E(a=>a.userexplist);const l=L(),j=async a=>{const p=localStorage.getItem("token");l(D(!0));const{id:u,name:d,phone:b,email:v,admin:x,verified:i}=t;console.log(t);try{const g=await fetch("/api/adminuserupdate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({id:u,name:d,phone:b,email:v,admin:x,verified:i})}),y=await g.json();g.ok?(f.success(y.message,{autoClose:1300}),m(),h(!1)):(f.warn(y.message,{autoClose:1300}),console.log(y)),l(D(!1))}catch(g){f.warn("Sopmething went wrong",{autoClose:1300}),console.log(g),l(D(!1))}};return document.querySelector(".modal"),e.jsx("div",{className:"modal",style:{display:S?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"User Detail"}),e.jsxs("span",{className:"wrapper",children:[e.jsx(k,{sx:{width:"90%",mt:3,mb:1},id:"outlined-basic",label:"Name",name:"name",value:t.name,type:"text",onChange:r,variant:"outlined"}),e.jsx(k,{sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Phone",name:"phone",onKeyPress:a=>{/[0-9]/.test(a.key)||a.preventDefault()},type:"tel",value:t.phone,onChange:r,variant:"outlined"}),e.jsx(k,{disabled:!0,sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Email",name:"email",value:t.email,type:"text",onChange:r,variant:"outlined"}),e.jsxs(A,{className:"caps",sx:{width:"90%",mt:1,mb:1},children:[e.jsx($,{id:"demo-simple-select-label",children:"Type"}),e.jsxs(F,{name:"admin",labelId:"demo-simple-select-label",onChange:r,value:t.admin,id:"demo-simple-select",label:"Type",children:[e.jsx(N,{className:"caps",value:!1,children:"User"}),e.jsx(N,{className:"caps",value:!0,children:"Admin"})]})]}),t.verified,e.jsxs(A,{className:"caps",sx:{width:"90%",mt:1,mb:2},children:[e.jsx($,{id:"demo-simple-select-label",children:"Verified"}),e.jsxs(F,{name:"verified",labelId:"demo-simple-select-label",onChange:r,value:t.verified,id:"demo-simple-select",label:"verified",children:[e.jsx(N,{className:"caps",value:!0,children:"Verified"}),e.jsx(N,{className:"caps",value:!1,children:"Unverified"})]})]}),e.jsxs("div",{className:"btn",children:[e.jsx(M,{className:"muibtn",onClick:j,variant:"contained",startIcon:e.jsx(K,{}),children:"Submit"}),e.jsx(M,{onClick:()=>h(!1),className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(_,{}),children:"Cancel"})]})]})]})})},se=()=>{L(),E(s=>s.userexplist);const[t,S]=c.useState([]);c.useEffect(()=>{h()},[]);const h=async()=>{const s=localStorage.getItem("token");try{const o=await fetch("/api/adminuser",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),n=await o.json();o.ok?S(n.users):f.warn(n.message?n.message:"You are not authorised",{autoClose:1500})}catch(o){console.log(o)}},r=new Date,[m,l]=c.useState("");c.useState(!1);let j=r.getMonth()+1,a=r.getUTCDate();j<10&&(j="0"+j),a<10&&(a="0"+a),r.getFullYear()+""+j+a;const p={id:"",name:"",phone:"",email:"",admin:"",verified:""},[u,d]=c.useState(p),[b,v]=c.useState(1),[x,i]=c.useState(10),[g,y]=c.useState(!1),R=s=>{let o=s.target.name,n=s.target.value;console.log(o," : ",n),d({...u,[o]:n})},U=async s=>{d({id:s._id,name:s.name,phone:s.phone,email:s.email,admin:s.isadmin,verified:s.isverified}),y(!0)},B=async s=>{Q({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async o=>{if(o)try{const n=f.loading("Please Wait..."),C=localStorage.getItem("token"),P=await fetch("/api/removeuser",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({id:s})}),Z=await P.json();P.ok&&(f.update(n,{render:"Deleted Successfully",type:"success",isLoading:!1,autoClose:1600}),h())}catch(n){f.update(id,{render:"Someting went wrong",type:"warn",isLoading:!1,autoClose:1600}),console.log(n)}})},O=s=>{i(s.target.value),v(1)},V=s=>{v(s)},z=s=>{l(s.target.value)};let w=b*x;const T=w-x,I=t.slice(T,w);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"allusers admin",children:[e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"All Users List"}),e.jsxs("span",{children:["Record :  ",e.jsxs("select",{name:"",id:"",value:x,onChange:O,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsx("span",{children:e.jsx("input",{type:"text",onChange:z,value:m,placeholder:"Type to search..."})})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Name "}),e.jsx("span",{children:"Phone"}),e.jsx("span",{children:"Email"}),e.jsxs("span",{children:[e.jsx(H,{style:{fontSize:"22px"}})," "]}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:"Date"})]}),e.jsx("div",{className:"body",id:"tablecontent",children:I&&I.map((s,o)=>{const n=new Date(s.createdAt),C=`${n.getUTCDate().toString().padStart(2,"0")} ${n.toLocaleString("default",{month:"short"})}, ${n.getFullYear().toString().substr(-2)}`;return e.jsxs("div",{children:[e.jsx("span",{children:o+1}),e.jsx("span",{children:s.name}),e.jsx("span",{children:s.phone}),e.jsx("span",{children:s.email}),e.jsx("span",{className:s.isverified?"status done":"status",children:s.isverified?"Yes":"No"}),e.jsxs("span",{children:[e.jsx(J,{className:"editicon ico",title:"Edit",onClick:()=>U(s)}),e.jsx(G,{className:"deleteicon ico",title:"Delete",onClick:()=>B(s._id)})]}),e.jsx("span",{children:C||""})]},o)})})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",T+1," To ",w>=t.length?w=t.length:w," of  ",t.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(W,{currentpage:b,changepageno:V,totalpost:t.length,postperpage:x})]})]}),e.jsx(X,{handler:R,inp:u,setinp:d,modal:g,setmodal:y,fetche:h})]})})};export{se as default};
