import{a as B,u as L,j as e,T as C,F as $,I as E,S as F,M as y,B as U,n as _,V as H,s as k,Q as r,r as o,o as J,H as G,p as K,P as Q,q as W}from"./index-DXS8Wphx.js";const X=({inp:a,modal:S,setmodal:c,handler:i,fetche:N})=>{B(d=>d.userexplist);const h=L(),D=async d=>{const u=localStorage.getItem("token");h(k(!0));const{id:m,name:w,phone:g,email:p,admin:f,verified:b}=a;console.log(a);try{const l=await fetch("/api/adminuserupdate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({id:m,name:w,phone:g,email:p,admin:f,verified:b})}),x=await l.json();l.ok?(r.success(x.message,{autoClose:1300}),N(),c(!1)):(r.warn(x.message,{autoClose:1300}),console.log(x)),h(k(!1))}catch(l){r.warn("Sopmething went wrong",{autoClose:1300}),console.log(l),h(k(!1))}};return document.querySelector(".modal"),e.jsx("div",{className:"modal",style:{display:S?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"User Detail"}),e.jsxs("span",{className:"wrapper",children:[e.jsx(C,{sx:{width:"90%",mt:3,mb:1},id:"outlined-basic",label:"Name",name:"name",value:a.name,type:"text",onChange:i,variant:"outlined"}),e.jsx(C,{sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Phone",name:"phone",onKeyPress:d=>{/[0-9]/.test(d.key)||d.preventDefault()},type:"tel",value:a.phone,onChange:i,variant:"outlined"}),e.jsx(C,{disabled:!0,sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Email",name:"email",value:a.email,type:"text",onChange:i,variant:"outlined"}),e.jsxs($,{className:"caps",sx:{width:"90%",mt:1,mb:1},children:[e.jsx(E,{id:"demo-simple-select-label",children:"Type"}),e.jsxs(F,{name:"admin",labelId:"demo-simple-select-label",onChange:i,value:a.admin,id:"demo-simple-select",label:"Type",children:[e.jsx(y,{className:"caps",value:!1,children:"User"}),e.jsx(y,{className:"caps",value:!0,children:"Admin"})]})]}),a.verified,e.jsxs($,{className:"caps",sx:{width:"90%",mt:1,mb:2},children:[e.jsx(E,{id:"demo-simple-select-label",children:"Verified"}),e.jsxs(F,{name:"verified",labelId:"demo-simple-select-label",onChange:i,value:a.verified,id:"demo-simple-select",label:"verified",children:[e.jsx(y,{className:"caps",value:!0,children:"Verified"}),e.jsx(y,{className:"caps",value:!1,children:"Unverified"})]})]}),e.jsxs("div",{className:"btn",children:[e.jsx(U,{className:"muibtn",onClick:D,variant:"contained",startIcon:e.jsx(_,{}),children:"Submit"}),e.jsx(U,{onClick:()=>c(!1),className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(H,{}),children:"Cancel"})]})]})]})})},se=()=>{L(),B(s=>s.userexplist);const[a,S]=o.useState([]);o.useEffect(()=>{c()},[]);const c=async()=>{const s=localStorage.getItem("token");try{const n=await fetch("/api/adminuser",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),t=await n.json();console.log("admin all users",t),n.ok?S(t.users):r.warn(t.message?t.message:"You are not authorised",{autoClose:1500})}catch(n){console.log(n)}},i=new Date,[N,h]=o.useState(""),[D,d]=o.useState(!1);let u=i.getMonth()+1,m=i.getUTCDate();u<10&&(u="0"+u),m<10&&(m="0"+m),i.getFullYear()+""+u+m;const w={id:"",name:"",phone:"",email:"",admin:"",verified:""},[g,p]=o.useState(w),[f,b]=o.useState(1),[l,x]=o.useState(10),[R,T]=o.useState(!1),M=s=>{let n=s.target.name,t=s.target.value;console.log(n," : ",t),p({...g,[n]:t})},O=async s=>{p({id:s._id,name:s.name,phone:s.phone,email:s.email,admin:s.isadmin,verified:s.isverified}),T(!0)},V=async s=>{W({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const t=r.loading("Please Wait..."),v=localStorage.getItem("token"),A=await fetch("/api/removeuser",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({id:s})}),Z=await A.json();A.ok&&(r.update(t,{render:"Deleted Successfully",type:"success",isLoading:!1,autoClose:1600}),c())}catch(t){r.update(id,{render:"Someting went wrong",type:"warn",isLoading:!1,autoClose:1600}),console.log(t)}})},q=s=>{x(s.target.value),b(1)},z=s=>{b(s)},Y=s=>{h(s.target.value)};let j=f*l;const I=j-l,P=a.slice(I,j);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"allusers admin",children:[e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"All Users List"}),e.jsxs("span",{children:["Record :  ",e.jsxs("select",{name:"",id:"",value:l,onChange:q,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsx("span",{children:e.jsx("input",{type:"text",onChange:Y,value:N,placeholder:"Type to search..."})})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Name "}),e.jsx("span",{children:"Phone"}),e.jsx("span",{children:"Email"}),e.jsx("span",{children:"Nos"}),e.jsxs("span",{children:[e.jsx(J,{style:{fontSize:"22px"}})," "]}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:"Date"})]}),e.jsx("div",{className:"body",id:"tablecontent",children:P&&P.map((s,n)=>{const t=new Date(s.createdAt),v=`${t.getUTCDate().toString().padStart(2,"0")} ${t.toLocaleString("default",{month:"short"})}, ${t.getFullYear().toString().substr(-2)}`;return e.jsxs("div",{children:[e.jsx("span",{children:n+1}),e.jsx("span",{children:s.name}),e.jsx("span",{children:s.phone}),e.jsx("span",{children:s.email}),e.jsx("span",{children:s.totalExpenses}),e.jsx("span",{className:s.isverified?"status done":"status",children:s.isverified?"Yes":"No"}),e.jsxs("span",{children:[e.jsx(G,{className:"editicon ico",title:"Edit",onClick:()=>O(s)}),e.jsx(K,{className:"deleteicon ico",title:"Delete",onClick:()=>V(s._id)})]}),e.jsx("span",{children:v||""})]},n)})})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",I+1," To ",j>=a.length?j=a.length:j," of  ",a.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(Q,{currentpage:f,changepageno:z,totalpost:a.length,postperpage:l})]})]}),e.jsx(X,{handler:M,inp:g,setinp:p,modal:R,setmodal:T,fetche:c})]})})};export{se as default};
