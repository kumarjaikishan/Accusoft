import{r as y,j as e,v as ge,w as je,c as K,f as W,o as B,F as ve,i as be,S as ye,T as U,x as Ce,B as T,M as Se,I as $e,Q as O,y as P,h as q,z as ke,A as ee,s as te,e as se,g as ne,G as we,b as De,R as Ne,d as F,m as Z,C as Ie,D as Me,E as Oe}from"./index-DRn1yZ0C.js";import{V as Le}from"./index-Yw7oDWcX.js";import{M as Ae}from"./MenuItem-CHU_ir0l.js";import{H as ae,R as ie,a as Te}from"./index-rt-OVZyO.js";const Ee=({totalpost:$,postperpage:w,changepageno:C,currentpage:S})=>{let v=[];const[u,b]=y.useState(5),[x,r]=y.useState(5),[c,g]=y.useState(0);for(let a=1;a<=Math.ceil($/w);a++)v.push(a);const D=v.map((a,t)=>{if(a<x+1&&a>c)return e.jsx("span",{onClick:()=>C(a),className:S==a?"pages active":"pages",children:a},t)}),o=()=>{r(x+u),g(c+u),x>=v.length-1&&(r(v.length),g(v.length-u))},h=()=>{r(x-u),g(c-u),c<=1&&(r(u),g(0))};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{title:"Previous 5 Pages",onClick:h}),D,e.jsx(je,{title:"Next 5 Pages",onClick:o})]})},ze=({modal:$,navigate:w,disable:C,init:S,handler:v,inp:u,isupdate:b,sub:x,setmodal:r,setisupdate:c,setinp:g})=>{var d;const D=K(i=>i.userexplist),o=W(),{request:h,loading:a}=B();y.useEffect(()=>{},[a]);const t=async i=>{let{ledger:s,date:f,amount:m,narration:k}=u;try{const N=await h({url:"updateexp",method:"POST",body:{_id:i,ledger:s,date:f,amount:m,narration:l(k)}});O.success(N==null?void 0:N.message,{autoClose:1300}),o(P()),g(S),c(!1),r(!1)}catch{}},l=i=>i.split(" ").map(m=>m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join(" ");var j=document.querySelector(".modal");const p=function(i){i.target==j&&r(!1)};return e.jsx("div",{className:"modal",onClick:p,style:{display:$?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"Add Voucher"}),e.jsxs("span",{className:"wrapper",children:[e.jsxs(ve,{className:"caps",sx:{width:"90%",mt:2,mb:2},children:[e.jsx(be,{id:"demo-simple-select-label",children:"Ledger"}),e.jsx(ye,{name:"ledger",labelId:"demo-simple-select-label",onChange:i=>v(i,"ledger"),value:u.ledger,id:"demo-simple-select",label:"Ledger",children:(d=D==null?void 0:D.ledgerlist)==null?void 0:d.map((i,s)=>e.jsx(Ae,{sx:{textTransform:"capitalize"},value:i._id,children:i.ledger},s))})]}),e.jsx(U,{type:"date",label:"Date",value:u.date,onChange:i=>v(i,"date"),sx:{width:"90%",mt:2,mb:2}}),e.jsx(U,{sx:{width:"90%",mt:2,mb:2},id:"outlined-basic",label:"Amount",name:"amount",onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},type:"tel",value:u.amount,onChange:i=>v(i,"amount"),InputProps:{startAdornment:e.jsx(Ce,{position:"start",children:"â‚¹"})},variant:"outlined"}),e.jsx(U,{multiline:!0,rows:2,sx:{width:"90%",mt:2,mb:2},id:"outlined-basic",label:"Narration",name:"narration",value:u.narration,type:"text",onChange:i=>v(i,"narration"),variant:"outlined"}),e.jsxs("div",{className:"btn",children:[b?e.jsx(T,{onClick:()=>t(u._id),variant:"contained",startIcon:e.jsx(Se,{}),children:"Update"}):e.jsx(T,{disabled:C,onClick:x,variant:"contained",startIcon:e.jsx($e,{}),children:"Submit"}),e.jsx(T,{onClick:()=>{r(!1),c(!1),g(S)},className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(Le,{}),children:"Cancel"})]})]})]})})},Pe=({setmodal:$,setdisable:w,isledupdate:C,setisledupdate:S})=>{var i;const v=W(),u=K(s=>s.userexplist),[b,x]=y.useState(!1);y.useEffect(()=>{},[]);const r={ind:"",ledger:"",budget:""},[c,g]=y.useState(r),D=s=>{g({...c,ledger:s.target.value})},o=s=>{const f=s.target.value;isNaN(f)||g({...c,budget:f})},{request:h,loading:a}=B();y.useEffect(()=>{v(q(a))},[a]);const t=async()=>{if(!c.ledger)return O.warn("Ledger Can't be Blank",{autoClose:1300});if(!c.budget)return O.warn("Budget Can't be Blank",{autoClose:1300});try{const s=await h({url:"addledger",method:"POST",body:{ledger:c.ledger,budget:parseFloat(c.budget)}});O.success(s.message,{autoClose:1300}),v(P()),g(r),w(!1)}catch{w(!1)}},l=async()=>{if(!c.ledger)return O.warn("Ledger Can't be Blank",{autoClose:1300});const s=c.ind,f=c.ledger,m=parseFloat(c.budget);localStorage.getItem("token"),w(!0);try{const k=await h({url:"updateledger",method:"POST",body:{ledger_id:s,newledger:f,newbudget:m}});O.success(k.message,{autoClose:1300}),g(r),x(!1),v(P())}catch{}finally{w(!1)}},j=async s=>{te({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async f=>{if(f){w(!0);try{const m=await h({url:"deleteledger",method:"POST",body:{ledgerid:s}});O.success(m.message,{autoClose:1300}),v(P())}catch{}finally{w(!1)}}})},p=(s,f,m)=>{g({ind:s,ledger:f,budget:m}),x(!0)},d=s=>{s.target.classList.contains("ledpage")&&S(!1)};return e.jsx("div",{className:"ledpage",onClick:d,style:{display:C?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsxs("h2",{children:["Hi, ",(i=u==null?void 0:u.user)==null?void 0:i.name]}),e.jsxs("span",{className:"ledwrapper",children:[e.jsxs("div",{className:"cont",children:[e.jsx(U,{label:"Enter Ledger",size:"small",variant:"outlined",style:{width:"250px"},value:c.ledger,onChange:D,className:"inpe"}),e.jsx(U,{label:"Budget",size:"small",variant:"outlined",value:c.budget,style:{width:"170px"},onChange:o,className:"inpe",type:"number"}),b?e.jsx(T,{size:"small",className:"btne",disabled:a,title:"Add",onClick:l,startIcon:e.jsx(ke,{}),variant:"contained",children:"Update"}):e.jsx(T,{size:"small",className:"btne",disabled:a,title:"Add",onClick:t,startIcon:e.jsx(ee,{}),variant:"contained",children:"Add"})]}),e.jsx("div",{className:"mater",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ledger"}),e.jsx("th",{children:"Budget"}),e.jsx("th",{children:"Edit"}),e.jsx("th",{children:"Delete"})]})}),e.jsx("tbody",{children:u.ledgerlist&&u.ledgerlist.map((s,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.ledger}),e.jsx("td",{children:s.budget}),e.jsx("td",{children:e.jsx(ae,{className:"editicon ico",title:"Edit",onClick:()=>p(s._id,s.ledger,s.budget)})}),e.jsx("td",{children:e.jsx(ie,{className:"deleteicon ico",title:"Delete",onClick:()=>j(s._id)})})]},f))})]})})]})]})})};var re={exports:{}};(function($,w){(function(C,S){$.exports=S()})(se,function(){var C="minute",S=/[+-]\d\d(?::?\d\d)?/g,v=/([+-]|\d\d)/g;return function(u,b,x){var r=b.prototype;x.utc=function(t){var l={date:t,utc:!0,args:arguments};return new b(l)},r.utc=function(t){var l=x(this.toDate(),{locale:this.$L,utc:!0});return t?l.add(this.utcOffset(),C):l},r.local=function(){return x(this.toDate(),{locale:this.$L,utc:!1})};var c=r.parse;r.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),c.call(this,t)};var g=r.init;r.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else g.call(this)};var D=r.utcOffset;r.utcOffset=function(t,l){var j=this.$utils().u;if(j(t))return this.$u?0:j(this.$offset)?D.call(this):this.$offset;if(typeof t=="string"&&(t=function(s){s===void 0&&(s="");var f=s.match(S);if(!f)return null;var m=(""+f[0]).match(v)||["-",0,0],k=m[0],N=60*+m[1]+ +m[2];return N===0?0:k==="+"?N:-N}(t),t===null))return this;var p=Math.abs(t)<=16?60*t:t;if(p===0)return this.utc(l);var d=this.clone();if(l)return d.$offset=p,d.$u=!1,d;var i=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(d=this.local().add(p+i,C)).$offset=p,d.$x.$localOffset=i,d};var o=r.format;r.format=function(t){var l=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return o.call(this,l)},r.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},r.isUTC=function(){return!!this.$u},r.toISOString=function(){return this.toDate().toISOString()},r.toString=function(){return this.toDate().toUTCString()};var h=r.toDate;r.toDate=function(t){return t==="s"&&this.$offset?x(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var a=r.diff;r.diff=function(t,l,j){if(t&&this.$u===t.$u)return a.call(this,t,l,j);var p=this.local(),d=x(t).local();return a.call(p,d,l,j)}}})})(re);var Ye=re.exports;const Ue=ne(Ye);var le={exports:{}};(function($,w){(function(C,S){$.exports=S()})(se,function(){var C={year:0,month:1,day:2,hour:3,minute:4,second:5},S={};return function(v,u,b){var x,r=function(o,h,a){a===void 0&&(a={});var t=new Date(o),l=function(j,p){p===void 0&&(p={});var d=p.timeZoneName||"short",i=j+"|"+d,s=S[i];return s||(s=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:j,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:d}),S[i]=s),s}(h,a);return l.formatToParts(t)},c=function(o,h){for(var a=r(o,h),t=[],l=0;l<a.length;l+=1){var j=a[l],p=j.type,d=j.value,i=C[p];i>=0&&(t[i]=parseInt(d,10))}var s=t[3],f=s===24?0:s,m=t[0]+"-"+t[1]+"-"+t[2]+" "+f+":"+t[4]+":"+t[5]+":000",k=+o;return(b.utc(m).valueOf()-(k-=k%1e3))/6e4},g=u.prototype;g.tz=function(o,h){o===void 0&&(o=x);var a,t=this.utcOffset(),l=this.toDate(),j=l.toLocaleString("en-US",{timeZone:o}),p=Math.round((l-new Date(j))/1e3/60),d=15*-Math.round(l.getTimezoneOffset()/15)-p;if(!Number(d))a=this.utcOffset(0,h);else if(a=b(j,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(d,!0),h){var i=a.utcOffset();a=a.add(t-i,"minute")}return a.$x.$timezone=o,a},g.offsetName=function(o){var h=this.$x.$timezone||b.tz.guess(),a=r(this.valueOf(),h,{timeZoneName:o}).find(function(t){return t.type.toLowerCase()==="timezonename"});return a&&a.value};var D=g.startOf;g.startOf=function(o,h){if(!this.$x||!this.$x.$timezone)return D.call(this,o,h);var a=b(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return D.call(a,o,h).tz(this.$x.$timezone,!0)},b.tz=function(o,h,a){var t=a&&h,l=a||h||x,j=c(+b(),l);if(typeof o!="string")return b(o).tz(l);var p=function(f,m,k){var N=f-60*m*1e3,L=c(N,k);if(m===L)return[N,m];var Y=c(N-=60*(L-m)*1e3,k);return L===Y?[N,L]:[f-60*Math.min(L,Y)*1e3,Math.max(L,Y)]}(b.utc(o,t).valueOf(),j,l),d=p[0],i=p[1],s=b(d).utcOffset(i);return s.$x.$timezone=l,s},b.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},b.tz.setDefault=function(o){x=o}}})})(le);var Fe=le.exports;const Re=ne(Fe);function qe($){return we({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"},child:[]}]})($)}F.extend(Ue);F.extend(Re);const Be=$=>$.split(" ").map(C=>C.charAt(0).toUpperCase()+C.slice(1).toLowerCase()).join(" "),We=()=>{var J;const $=W();let w=De();const C=K(n=>n.userexplist),[S,v]=y.useState(""),[u,b]=y.useState(""),x=Ne.useRef(!1),[r,c]=y.useState(!1),[g,D]=y.useState(!1),[o,h]=y.useState(!1),[a,t]=y.useState(1),[l,j]=y.useState(10),[p,d]=y.useState(!1),[i,s]=y.useState(!1),f={_id:"",ledger:"",date:F().format("YYYY-MM-DD"),amount:"",narration:""},[m,k]=y.useState(f),{request:N,loading:L}=B(),{request:Y,loading:V}=B();y.useEffect(()=>{$(q(L))},[L]),y.useEffect(()=>{$(q(V))},[V]),y.useEffect(()=>{s(!0);const n=setTimeout(()=>{b(S.toLowerCase()),s(!1)},1300);return()=>clearTimeout(n)},[S]);const oe=(n,I)=>{k({...m,[I]:n.target.value})},ce=async()=>{let{ledger:n,date:I,amount:M,narration:E}=m;if(!n||!I||!M||!E){const X=document.querySelector(".box");return X.classList.add("shake"),setTimeout(()=>X.classList.remove("shake"),420),$(q(!1)),O.warn("Kindly Fill all Fields",{autoClose:1700})}const z=await N({url:"addexpense",method:"POST",body:{ledger:n,date:I,amount:M,narration:Be(E)}});O.success(z==null?void 0:z.message,{autoClose:1300}),$(P()),d(!1),k(f)},de=n=>{k({_id:n._id,ledger:n.ledger._id,date:F(n.date).format("YYYY-MM-DD"),amount:n.amount,narration:n.narration}),c(!0),d(!0)},ue=n=>{x.current=!0,G([n])},he=()=>{const n=document.querySelectorAll("#tablecontent input:checked"),I=Array.from(n).map(M=>M.id);G(I)},G=async n=>{if(n.length<1)return O.warn("Kindly Select Atlest 1 Entry",{autoClose:1700});te({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async I=>{if(I){const M=await Y({url:"delmany",method:"POST",body:{id:n}});O.success(M==null?void 0:M.message,{autoClose:1800}),$(P()),document.querySelectorAll("#tablecontent input:checked").forEach(E=>E.checked=!1),setTimeout(()=>{x.current=!1},100),_()}})},me=()=>{const n=document.querySelector("#allcheck");document.querySelectorAll("#tablecontent input").forEach(M=>M.checked=n.checked),_()},fe=n=>{j(Number(n.target.value)),t(1)},pe=n=>{t(n)},_=()=>{const n=document.querySelectorAll("#tablecontent input"),I=document.querySelectorAll("#tablecontent div");n.forEach((M,E)=>{const z=I[E];M.checked?z.classList.add("checked"):z.classList.remove("checked")})},A=((J=C==null?void 0:C.explist)==null?void 0:J.filter(n=>u===""||n.narration.toLowerCase().includes(u)||n.ledger.ledger.toLowerCase().includes(u)||n.amount.toString().includes(u)))||[];let R=a*l;const H=R-l,Q=A.slice(H,R),xe={visible:{transition:{delayChildren:.1}}};return e.jsx(e.Fragment,{children:e.jsxs(Z.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"-100%"},transition:{duration:.2,ease:"easeInOut"},className:p||o?"exp ismodal":"exp",children:[e.jsxs("div",{className:"add",children:[e.jsx(T,{title:"Add Expense",onClick:()=>d(!0),startIcon:e.jsx(ee,{}),variant:"contained",children:"Add Expense"}),e.jsx(T,{title:"Ledger",onClick:()=>h(!0),startIcon:e.jsx(Ie,{}),variant:"outlined",children:"Ledger"})]}),e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"Expense List "}),e.jsxs("span",{children:["Record :"," ",e.jsxs("select",{title:"Items Per Page",value:l,onChange:fe,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsxs("span",{children:[e.jsx("input",{type:"text",title:"Search",onChange:n=>v(n.target.value),value:S,placeholder:"Type to search..."}),i?e.jsxs("span",{title:"Searching",children:["  ",e.jsx(qe,{className:"spin"})," "]}):e.jsxs("span",{title:"clear",onClick:()=>v(""),children:["   ",e.jsx(Me,{})]})]})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Ledger"}),e.jsx("span",{children:"Amt. "}),e.jsx("span",{children:"Narration"}),e.jsx("span",{children:"Date "}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:e.jsx("input",{type:"checkbox",onClick:me,id:"allcheck"})})]}),e.jsxs(Z.div,{variants:xe,initial:"hidden",animate:"visible",className:"body",id:"tablecontent",children:[A.length<1&&e.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"8px 0"},children:e.jsx("b",{children:"No Expense Added"})}),e.jsxs(Oe,{children:[Q.map((n,I)=>e.jsxs(Z.div,{exit:x.current?{opacity:1,x:"-102%",transition:{duration:.6}}:{},children:[e.jsx("span",{children:H+I+1}),e.jsx("span",{className:"caps",children:n.ledger.ledger}),e.jsx("span",{children:n.amount}),e.jsx("span",{children:n.narration}),e.jsx("span",{children:F(n.date).format("DD MMM, YYYY")}),e.jsxs("span",{children:[e.jsx(ae,{title:"Edit",onClick:()=>de(n),className:"editicon ico"}),e.jsx(ie,{title:"Delete",onClick:()=>ue(n._id),className:"deleteicon ico"})]}),e.jsx("span",{children:e.jsx("input",{type:"checkbox",title:"select",onClick:_,id:n._id})})]},n._id)),e.jsxs("div",{id:"foot",children:[e.jsx("span",{}),e.jsx("span",{style:{fontWeight:700},children:"Total"}),e.jsx("span",{style:{fontWeight:700},id:"totalhere",children:Q.reduce((n,I)=>n+I.amount,0)}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{colSpan:"1",id:"alldelete",title:"Delete Selected Item",children:e.jsx(Te,{onClick:he})}),e.jsx("span",{})]})]})]})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",A.length===0?0:H+1," To"," ",R>=A.length?A.length:R," of"," ",A.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(Ee,{currentpage:a,changepageno:pe,totalpost:A.length,postperpage:l})]})]}),e.jsx(ze,{init:f,setdisable:D,disable:L,setinp:k,setisupdate:c,setmodal:d,sub:ce,modal:p,handler:oe,inp:m,isupdate:r,navigate:w}),e.jsx(Pe,{navigate:w,setmodal:d,setdisable:D,disable:g,setisledupdate:h,isledupdate:o})]})})};export{We as default};
