import{u as $,a as F,r as l,s as h,h as x,j as e,P as L,Q as j,g as b}from"./index-5a0aa107.js";const K=()=>{const i=$();F(t=>t.userexplist);const[c,w]=l.useState([]);l.useEffect(()=>{g()},[]);let o=[];const g=async()=>{const t=localStorage.getItem("token");i(h(!0));try{const n=await fetch("/api/adminexp",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),s=await n.json();console.log("whole",s),n.ok&&(w(s.explist),i(h(!1)))}catch(n){console.log(n)}},m=new Date,[C,A]=l.useState("");l.useState(!1),m.getMonth()+1,m.getUTCDate();const D={_id:"",ledger:"",date:x(),amount:"",narration:""},[O,N]=l.useState(D),[f,y]=l.useState(1),[d,E]=l.useState(10),[z,q]=l.useState(!1),T=async t=>{N({_id:t._id,ledger:t.ledger._id,date:x(t.date),amount:t.amount,narration:t.narration}),q(!0)},R=async t=>{o=[],o.push(t),S(o)},Y=async()=>{o=[],document.querySelectorAll("#tablecontent input:checked").forEach(n=>{o.push(n.id)}),S(o)},S=async t=>{if(t.length<1)return j.warn("Kindly Select Atlest 1 Entry",{autoClose:1700});const n=localStorage.getItem("token");b({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async s=>{if(s){i(h(!0));try{const a=await fetch("/api/deletemanyexp",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({id:t})}),B=await a.json();if(a.ok){j.success("Deleted Successfully",{autoClose:1300}),i(h(!1)),g();const v=document.querySelectorAll("#tablecontent input:checked"),G=document.querySelectorAll("#tablecontent tr");v.forEach(P=>{P.checked=!1}),u()}else j.warn("Something went wrong",{autoClose:1800})}catch(a){console.log(a)}}else b("Your data is safe!")})},_=()=>{const t=document.querySelector("#allcheck"),n=document.querySelectorAll("#tablecontent input");if(t.checked==!0)for(let s=0;s<n.length;s++)n[s].checked=!0;else for(let s=0;s<n.length;s++)n[s].checked=!1;u()},I=t=>{E(t.target.value),y(1)},M=t=>{y(t)},U=t=>{A(t.target.value)},u=()=>{const t=document.querySelectorAll("#tablecontent input");document.querySelectorAll("#tablecontent tr");for(let s=0;s<t.length;s++){var n=t[s].parentNode.parentNode;t[s].checked?(n.style.background="rgb(16 135 129)",n.style.color="white"):(n.style.background="transparent",n.style.color="black")}};let r=f*d;const p=r-d,k=c.slice(p,r);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"adminexp",children:[e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"All User Expense List"}),e.jsxs("span",{children:["Record :  ",e.jsxs("select",{name:"",id:"",value:d,onChange:I,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsx("span",{children:e.jsx("input",{type:"text",onChange:U,value:C,placeholder:"Type to search..."})})]}),e.jsx("div",{className:"table",children:e.jsxs("table",{cellSpacing:"15",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.no"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Ledger"}),e.jsx("th",{children:"Amt."}),e.jsx("th",{children:"Narration"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"}),e.jsx("th",{children:e.jsx("input",{type:"checkbox",onClick:_,id:"allcheck"})})]})}),e.jsx("tbody",{id:"tablecontent",children:k&&k.map((t,n)=>{let s=new Date(t.date),a=s.getUTCDate();return a<10&&(a="0"+s.getUTCDate()),a+""+s.toLocaleString("default",{month:"short"})+s.getFullYear().toString().substr(-2),e.jsxs("tr",{children:[e.jsx("td",{children:p+n+1}),e.jsx("td",{className:"caps",children:t.userid.name}),e.jsx("td",{className:"caps",children:t.ledger.ledger}),e.jsx("td",{children:t.amount}),e.jsx("td",{children:t.narration}),e.jsxs("td",{children:[" ",x(t.date).format("DD MMM, YYYY")]}),e.jsxs("td",{children:[e.jsx("i",{title:"Edit",onClick:()=>T(t),className:"fa fa-pencil-square-o","aria-hidden":"true"}),e.jsx("i",{title:"Delete",onClick:()=>R(t._id),className:"fa fa-trash-o","aria-hidden":"true"})]}),e.jsx("td",{children:e.jsx("input",{type:"checkbox",onClick:u,id:t._id})})]},n)})}),e.jsx("tfoot",{children:e.jsxs("tr",{id:"foot",children:[e.jsx("th",{colSpan:"2"}),e.jsx("th",{colSpan:"1",children:"Total"}),e.jsx("th",{}),e.jsx("th",{colSpan:"2"}),e.jsx("th",{colSpan:"1",id:"alldelete",title:"Delete",children:e.jsx("i",{onClick:Y,className:"fa fa-trash","aria-hidden":"true"})}),e.jsx("th",{colSpan:"1"})]})})]})}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",p+1," To ",r>=c.length?r=c.length:r," of  ",c.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(L,{currentpage:f,changepageno:M,totalpost:c.length,postperpage:d})]})]})]})})};export{K as default};
