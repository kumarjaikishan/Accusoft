import{r as C,j as e,v as je,w as ve,c as W,f as V,o as B,F as be,i as ye,S as Ce,T as U,x as Se,B as T,M as $e,I as ke,Q as O,y as P,h as q,z as we,A as te,s as se,e as ne,g as ae,G as De,b as Ne,R as Me,d as F,C as Ie,m as K,D as Oe,E as Le,H as Ae}from"./index-CO6iBSaM.js";import{V as Te}from"./index-DFBh5lfG.js";import{M as ze}from"./MenuItem-CFKVzSAy.js";import{H as ie,R as re,a as Ee}from"./index-CQhs0YWA.js";const Pe=({totalpost:$,postperpage:w,changepageno:S,currentpage:b})=>{let f=[];const[x,y]=C.useState(5),[h,o]=C.useState(5),[c,p]=C.useState(0);for(let s=1;s<=Math.ceil($/w);s++)f.push(s);const N=f.map((s,t)=>{if(s<h+1&&s>c)return e.jsx("span",{onClick:()=>S(s),className:b==s?"pages active":"pages",children:s},t)}),l=()=>{o(h+x),p(c+x),h>=f.length-1&&(o(f.length),p(f.length-x))},d=()=>{o(h-x),p(c-x),c<=1&&(o(x),p(0))};return e.jsxs(e.Fragment,{children:[e.jsx(je,{title:"Previous 5 Pages",onClick:d}),N,e.jsx(ve,{title:"Next 5 Pages",onClick:l})]})},Ye=({modal:$,navigate:w,disable:S,handlechange:b,fields:f,isupdate:x,sub:y,setmodal:h,setisupdate:o,reset:c})=>{var m;const p=W(i=>i.userexplist),N=V(),{request:l,loading:d}=B();C.useEffect(()=>{},[d]);const s=async i=>{let{ledger:j,date:n,amount:u,narration:v}=f;try{const k=await l({url:"updateexp",method:"POST",body:{_id:i,ledger:j,date:n,amount:u,narration:t(v)}});O.success(k==null?void 0:k.message,{autoClose:1300}),N(P()),c(),o(!1),h(!1)}catch{}},t=i=>i.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1).toLowerCase()).join(" ");var r=document.querySelector(".modal");const g=function(i){i.target==r&&h(!1)};return e.jsx("div",{className:"modal",onClick:g,style:{display:$?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"Add Voucher"}),e.jsxs("span",{className:"wrapper",children:[e.jsxs(be,{className:"caps",sx:{width:"90%",mt:2,mb:2},children:[e.jsx(ye,{id:"demo-simple-select-label",children:"Ledger"}),e.jsx(Ce,{name:"ledger",labelId:"demo-simple-select-label",onChange:b,value:f.ledger,id:"demo-simple-select",label:"Ledger",children:(m=p==null?void 0:p.ledgerlist)==null?void 0:m.map((i,j)=>e.jsx(ze,{sx:{textTransform:"capitalize"},value:i._id,children:i.ledger},j))})]}),e.jsx(U,{type:"date",label:"Date",value:f.date,name:"date",onChange:b,sx:{width:"90%",mt:2,mb:2}}),e.jsx(U,{sx:{width:"90%",mt:2,mb:2},id:"outlined-basic",label:"Amount",name:"amount",onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},type:"tel",value:f.amount,onChange:b,InputProps:{startAdornment:e.jsx(Se,{position:"start",children:"â‚¹"})},variant:"outlined"}),e.jsx(U,{multiline:!0,rows:2,sx:{width:"90%",mt:2,mb:2},id:"outlined-basic",label:"Narration",name:"narration",value:f.narration,type:"text",onChange:b,variant:"outlined"}),e.jsxs("div",{className:"btn",children:[x?e.jsx(T,{onClick:()=>s(f._id),variant:"contained",startIcon:e.jsx($e,{}),children:"Update"}):e.jsx(T,{disabled:S,onClick:y,variant:"contained",startIcon:e.jsx(ke,{}),children:"Submit"}),e.jsx(T,{onClick:()=>{h(!1),o(!1),c()},className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(Te,{}),children:"Cancel"})]})]})]})})},Ue=({setmodal:$,setdisable:w,isledupdate:S,setisledupdate:b})=>{var j;const f=V(),x=W(n=>n.userexplist),[y,h]=C.useState(!1);C.useEffect(()=>{},[]);const o={ind:"",ledger:"",budget:""},[c,p]=C.useState(o),N=n=>{p({...c,ledger:n.target.value})},l=n=>{const u=n.target.value;isNaN(u)||p({...c,budget:u})},{request:d,loading:s}=B();C.useEffect(()=>{f(q(s))},[s]);const t=async()=>{if(!c.ledger)return O.warn("Ledger Can't be Blank",{autoClose:1300});if(!c.budget)return O.warn("Budget Can't be Blank",{autoClose:1300});try{const n=await d({url:"addledger",method:"POST",body:{ledger:c.ledger,budget:parseFloat(c.budget)}});O.success(n.message,{autoClose:1300}),f(P()),p(o),w(!1)}catch{w(!1)}},r=async()=>{if(!c.ledger)return O.warn("Ledger Can't be Blank",{autoClose:1300});const n=c.ind,u=c.ledger,v=parseFloat(c.budget);localStorage.getItem("token"),w(!0);try{const k=await d({url:"updateledger",method:"POST",body:{ledger_id:n,newledger:u,newbudget:v}});O.success(k.message,{autoClose:1300}),p(o),h(!1),f(P())}catch{}finally{w(!1)}},g=async n=>{se({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async u=>{if(u){w(!0);try{const v=await d({url:"deleteledger",method:"POST",body:{ledgerid:n}});O.success(v.message,{autoClose:1300}),f(P())}catch{}finally{w(!1)}}})},m=(n,u,v)=>{p({ind:n,ledger:u,budget:v}),h(!0)},i=n=>{n.target.classList.contains("ledpage")&&b(!1)};return e.jsx("div",{className:"ledpage",onClick:i,style:{display:S?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsxs("h2",{children:["Hi, ",(j=x==null?void 0:x.user)==null?void 0:j.name]}),e.jsxs("span",{className:"ledwrapper",children:[e.jsxs("div",{className:"cont",children:[e.jsx(U,{label:"Enter Ledger",size:"small",variant:"outlined",style:{width:"250px"},value:c.ledger,onChange:N,className:"inpe"}),e.jsx(U,{label:"Budget",size:"small",variant:"outlined",value:c.budget,style:{width:"170px"},onChange:l,className:"inpe",type:"number"}),y?e.jsx(T,{size:"small",className:"btne",disabled:s,title:"Add",onClick:r,startIcon:e.jsx(we,{}),variant:"contained",children:"Update"}):e.jsx(T,{size:"small",className:"btne",disabled:s,title:"Add",onClick:t,startIcon:e.jsx(te,{}),variant:"contained",children:"Add"})]}),e.jsx("div",{className:"mater",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ledger"}),e.jsx("th",{children:"Budget"}),e.jsx("th",{children:"Edit"}),e.jsx("th",{children:"Delete"})]})}),e.jsx("tbody",{children:x.ledgerlist&&x.ledgerlist.map((n,u)=>e.jsxs("tr",{children:[e.jsx("td",{children:n.ledger}),e.jsx("td",{children:n.budget}),e.jsx("td",{children:e.jsx(ie,{className:"editicon ico",title:"Edit",onClick:()=>m(n._id,n.ledger,n.budget)})}),e.jsx("td",{children:e.jsx(re,{className:"deleteicon ico",title:"Delete",onClick:()=>g(n._id)})})]},u))})]})})]})]})})};var oe={exports:{}};(function($,w){(function(S,b){$.exports=b()})(ne,function(){var S="minute",b=/[+-]\d\d(?::?\d\d)?/g,f=/([+-]|\d\d)/g;return function(x,y,h){var o=y.prototype;h.utc=function(t){var r={date:t,utc:!0,args:arguments};return new y(r)},o.utc=function(t){var r=h(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),S):r},o.local=function(){return h(this.toDate(),{locale:this.$L,utc:!1})};var c=o.parse;o.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),c.call(this,t)};var p=o.init;o.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else p.call(this)};var N=o.utcOffset;o.utcOffset=function(t,r){var g=this.$utils().u;if(g(t))return this.$u?0:g(this.$offset)?N.call(this):this.$offset;if(typeof t=="string"&&(t=function(n){n===void 0&&(n="");var u=n.match(b);if(!u)return null;var v=(""+u[0]).match(f)||["-",0,0],k=v[0],I=60*+v[1]+ +v[2];return I===0?0:k==="+"?I:-I}(t),t===null))return this;var m=Math.abs(t)<=16?60*t:t;if(m===0)return this.utc(r);var i=this.clone();if(r)return i.$offset=m,i.$u=!1,i;var j=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(i=this.local().add(m+j,S)).$offset=m,i.$x.$localOffset=j,i};var l=o.format;o.format=function(t){var r=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,r)},o.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var d=o.toDate;o.toDate=function(t){return t==="s"&&this.$offset?h(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var s=o.diff;o.diff=function(t,r,g){if(t&&this.$u===t.$u)return s.call(this,t,r,g);var m=this.local(),i=h(t).local();return s.call(m,i,r,g)}}})})(oe);var Fe=oe.exports;const Re=ae(Fe);var le={exports:{}};(function($,w){(function(S,b){$.exports=b()})(ne,function(){var S={year:0,month:1,day:2,hour:3,minute:4,second:5},b={};return function(f,x,y){var h,o=function(l,d,s){s===void 0&&(s={});var t=new Date(l),r=function(g,m){m===void 0&&(m={});var i=m.timeZoneName||"short",j=g+"|"+i,n=b[j];return n||(n=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:g,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:i}),b[j]=n),n}(d,s);return r.formatToParts(t)},c=function(l,d){for(var s=o(l,d),t=[],r=0;r<s.length;r+=1){var g=s[r],m=g.type,i=g.value,j=S[m];j>=0&&(t[j]=parseInt(i,10))}var n=t[3],u=n===24?0:n,v=t[0]+"-"+t[1]+"-"+t[2]+" "+u+":"+t[4]+":"+t[5]+":000",k=+l;return(y.utc(v).valueOf()-(k-=k%1e3))/6e4},p=x.prototype;p.tz=function(l,d){l===void 0&&(l=h);var s,t=this.utcOffset(),r=this.toDate(),g=r.toLocaleString("en-US",{timeZone:l}),m=Math.round((r-new Date(g))/1e3/60),i=15*-Math.round(r.getTimezoneOffset()/15)-m;if(!Number(i))s=this.utcOffset(0,d);else if(s=y(g,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(i,!0),d){var j=s.utcOffset();s=s.add(t-j,"minute")}return s.$x.$timezone=l,s},p.offsetName=function(l){var d=this.$x.$timezone||y.tz.guess(),s=o(this.valueOf(),d,{timeZoneName:l}).find(function(t){return t.type.toLowerCase()==="timezonename"});return s&&s.value};var N=p.startOf;p.startOf=function(l,d){if(!this.$x||!this.$x.$timezone)return N.call(this,l,d);var s=y(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return N.call(s,l,d).tz(this.$x.$timezone,!0)},y.tz=function(l,d,s){var t=s&&d,r=s||d||h,g=c(+y(),r);if(typeof l!="string")return y(l).tz(r);var m=function(u,v,k){var I=u-60*v*1e3,L=c(I,k);if(v===L)return[I,v];var Y=c(I-=60*(L-v)*1e3,k);return L===Y?[I,L]:[u-60*Math.min(L,Y)*1e3,Math.max(L,Y)]}(y.utc(l,t).valueOf(),g,r),i=m[0],j=m[1],n=y(i).utcOffset(j);return n.$x.$timezone=r,n},y.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},y.tz.setDefault=function(l){h=l}}})})(le);var qe=le.exports;const Be=ae(qe);function He($){return De({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"},child:[]}]})($)}F.extend(Re);F.extend(Be);const _e=$=>$.split(" ").map(S=>S.charAt(0).toUpperCase()+S.slice(1).toLowerCase()).join(" "),Ge=()=>{var X;const $=V();let w=Ne();const S=W(a=>a.userexplist),[b,f]=C.useState(""),[x,y]=C.useState(""),h=Me.useRef(!1),[o,c]=C.useState(!1),[p,N]=C.useState(!1),[l,d]=C.useState(!1),[s,t]=C.useState(1),[r,g]=C.useState(10),[m,i]=C.useState(!1),[j,n]=C.useState(!1),u={_id:"",ledger:"",date:F().format("YYYY-MM-DD"),amount:"",narration:""},{fields:v,handlechange:k,reset:I,editfields:L}=Ie(u),{request:Y,loading:H}=B(),{request:ce,loading:G}=B();C.useEffect(()=>{$(q(H))},[H]),C.useEffect(()=>{$(q(G))},[G]),C.useEffect(()=>{n(!0);const a=setTimeout(()=>{y(b.toLowerCase()),n(!1)},1300);return()=>clearTimeout(a)},[b]);const de=async()=>{let{ledger:a,date:D,amount:M,narration:z}=v;if(!a||!D||!M||!z){const ee=document.querySelector(".box");return ee.classList.add("shake"),setTimeout(()=>ee.classList.remove("shake"),420),$(q(!1)),O.warn("Kindly Fill all Fields",{autoClose:1700})}const E=await Y({url:"addexpense",method:"POST",body:{ledger:a,date:D,amount:M,narration:_e(z)}});O.success(E==null?void 0:E.message,{autoClose:1300}),$(P()),i(!1),I()},ue=a=>{const D={_id:a._id,ledger:a.ledger._id,date:F(a.date).format("YYYY-MM-DD"),amount:a.amount,narration:a.narration};L(D),c(!0),i(!0)},he=a=>{h.current=!0,Q([a])},me=()=>{const a=document.querySelectorAll("#tablecontent input:checked"),D=Array.from(a).map(M=>M.id);Q(D)},Q=async a=>{if(a.length<1)return O.warn("Kindly Select Atlest 1 Entry",{autoClose:1700});se({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async D=>{if(D){const M=await ce({url:"delmany",method:"POST",body:{id:a}});O.success(M==null?void 0:M.message,{autoClose:1800}),$(P()),document.querySelectorAll("#tablecontent input:checked").forEach(z=>z.checked=!1),setTimeout(()=>{h.current=!1},100),_()}})},fe=()=>{const a=document.querySelector("#allcheck");document.querySelectorAll("#tablecontent input").forEach(M=>M.checked=a.checked),_()},pe=a=>{g(Number(a.target.value)),t(1)},xe=a=>{t(a)},_=()=>{const a=document.querySelectorAll("#tablecontent input"),D=document.querySelectorAll("#tablecontent div");a.forEach((M,z)=>{const E=D[z];M.checked?E.classList.add("checked"):E.classList.remove("checked")})},A=((X=S==null?void 0:S.explist)==null?void 0:X.filter(a=>x===""||a.narration.toLowerCase().includes(x)||a.ledger.ledger.toLowerCase().includes(x)||a.amount.toString().includes(x)))||[];let R=s*r;const Z=R-r,J=A.slice(Z,R),ge={visible:{transition:{delayChildren:.1}}};return e.jsx(e.Fragment,{children:e.jsxs(K.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"-100%"},transition:{duration:.2,ease:"easeInOut"},className:m||l?"exp ismodal":"exp",children:[e.jsxs("div",{className:"add",children:[e.jsx(T,{title:"Add Expense",onClick:()=>i(!0),startIcon:e.jsx(te,{}),variant:"contained",children:"Add Expense"}),e.jsx(T,{title:"Ledger",onClick:()=>d(!0),startIcon:e.jsx(Oe,{}),variant:"outlined",children:"Ledger"})]}),e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"Expense List "}),e.jsxs("span",{children:["Record :"," ",e.jsxs("select",{title:"Items Per Page",value:r,onChange:pe,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsxs("span",{children:[e.jsx("input",{type:"text",title:"Search",onChange:a=>f(a.target.value),value:b,placeholder:"Type to search..."}),j?e.jsxs("span",{title:"Searching",children:["  ",e.jsx(He,{className:"spin"})," "]}):e.jsxs("span",{title:"clear",onClick:()=>f(""),children:["   ",e.jsx(Le,{})]})]})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Ledger"}),e.jsx("span",{children:"Amt. "}),e.jsx("span",{children:"Narration"}),e.jsx("span",{children:"Date "}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:e.jsx("input",{type:"checkbox",onClick:fe,id:"allcheck"})})]}),e.jsxs(K.div,{variants:ge,initial:"hidden",animate:"visible",className:"body",id:"tablecontent",children:[A.length<1&&e.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"8px 0"},children:e.jsx("b",{children:"No Expense Added"})}),e.jsxs(Ae,{children:[J.map((a,D)=>e.jsxs(K.div,{exit:h.current?{opacity:1,x:"-102%",transition:{duration:.6}}:{},children:[e.jsx("span",{children:Z+D+1}),e.jsx("span",{className:"caps",children:a.ledger.ledger}),e.jsx("span",{children:a.amount}),e.jsx("span",{children:a.narration}),e.jsx("span",{children:F(a.date).format("DD MMM, YYYY")}),e.jsxs("span",{children:[e.jsx(ie,{title:"Edit",onClick:()=>ue(a),className:"editicon ico"}),e.jsx(re,{title:"Delete",onClick:()=>he(a._id),className:"deleteicon ico"})]}),e.jsx("span",{children:e.jsx("input",{type:"checkbox",title:"select",onClick:_,id:a._id})})]},a._id)),e.jsxs("div",{id:"foot",children:[e.jsx("span",{}),e.jsx("span",{style:{fontWeight:700},children:"Total"}),e.jsx("span",{style:{fontWeight:700},id:"totalhere",children:J.reduce((a,D)=>a+D.amount,0)}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{colSpan:"1",id:"alldelete",title:"Delete Selected Item",children:e.jsx(Ee,{onClick:me})}),e.jsx("span",{})]})]})]})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",A.length===0?0:Z+1," To"," ",R>=A.length?A.length:R," of"," ",A.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(Pe,{currentpage:s,changepageno:xe,totalpost:A.length,postperpage:r})]})]}),e.jsx(Ye,{init:u,setdisable:N,disable:H,reset:I,setisupdate:c,setmodal:i,sub:de,modal:m,handlechange:k,fields:v,isupdate:o,navigate:w}),e.jsx(Ue,{navigate:w,setmodal:i,setdisable:N,disable:p,setisledupdate:d,isledupdate:l})]})})};export{Ge as default};
