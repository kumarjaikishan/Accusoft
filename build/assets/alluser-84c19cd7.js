import{a as U,u as B,j as e,T as k,F as A,I as $,S as E,M as y,B as F,h as Y,V as q,s as D,Q as r,r as o,i as _,H,k as J,P as G,l as K}from"./index-36b1631f.js";const Q=({inp:t,modal:S,setmodal:c,handler:l,fetche:w})=>{U(i=>i.userexplist);const p=B(),d=async i=>{const N=localStorage.getItem("token");p(D(!0));const{id:g,name:x,phone:f,email:b,admin:u,verified:C}=t;console.log(t);try{const m=await fetch("/api/adminuserupdate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({id:g,name:x,phone:f,email:b,admin:u,verified:C})}),h=await m.json();m.ok?(r.success(h.message,{autoClose:1300}),w(),c(!1)):(r.warn(h.message,{autoClose:1300}),console.log(h)),p(D(!1))}catch(m){r.warn("Sopmething went wrong",{autoClose:1300}),console.log(m),p(D(!1))}};return document.querySelector(".modal"),e.jsx("div",{className:"modal",style:{display:S?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"User Detail"}),e.jsxs("span",{className:"wrapper",children:[e.jsx(k,{sx:{width:"90%",mt:3,mb:1},id:"outlined-basic",label:"Name",name:"name",value:t.name,type:"text",onChange:l,variant:"outlined"}),e.jsx(k,{sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Phone",name:"phone",onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},type:"tel",value:t.phone,onChange:l,variant:"outlined"}),e.jsx(k,{disabled:!0,sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Email",name:"email",value:t.email,type:"text",onChange:l,variant:"outlined"}),e.jsxs(A,{className:"caps",sx:{width:"90%",mt:1,mb:1},children:[e.jsx($,{id:"demo-simple-select-label",children:"Type"}),e.jsxs(E,{name:"admin",labelId:"demo-simple-select-label",onChange:l,value:t.admin,id:"demo-simple-select",label:"Type",children:[e.jsx(y,{className:"caps",value:!1,children:"User"}),e.jsx(y,{className:"caps",value:!0,children:"Admin"})]})]}),t.verified,e.jsxs(A,{className:"caps",sx:{width:"90%",mt:1,mb:2},children:[e.jsx($,{id:"demo-simple-select-label",children:"Verified"}),e.jsxs(E,{name:"verified",labelId:"demo-simple-select-label",onChange:l,value:t.verified,id:"demo-simple-select",label:"verified",children:[e.jsx(y,{className:"caps",value:!0,children:"Verified"}),e.jsx(y,{className:"caps",value:!1,children:"Unverified"})]})]}),e.jsxs("div",{className:"btn",children:[e.jsx(F,{className:"muibtn",onClick:d,variant:"contained",startIcon:e.jsx(Y,{}),children:"Submit"}),e.jsx(F,{onClick:()=>c(!1),className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(q,{}),children:"Cancel"})]})]})]})})},Z=()=>{B(),U(s=>s.userexplist);const[t,S]=o.useState([]);o.useEffect(()=>{c()},[]);const c=async()=>{const s=localStorage.getItem("token");try{const n=await fetch("/api/adminuser",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),a=await n.json();n.ok?S(a.users):r.warn(a.message?a.message:"You are not authorised",{autoClose:1500})}catch(n){console.log(n)}},l=new Date,[w,p]=o.useState("");o.useState(!1);let d=l.getMonth()+1,i=l.getUTCDate();d<10&&(d="0"+d),i<10&&(i="0"+i),l.getFullYear()+""+d+i;const N={id:"",name:"",phone:"",email:"",admin:"",verified:""},[g,x]=o.useState(N),[f,b]=o.useState(1),[u,C]=o.useState(10),[m,h]=o.useState(!1),L=s=>{let n=s.target.name,a=s.target.value;console.log(n," : ",a),x({...g,[n]:a})},R=async s=>{x({id:s._id,name:s.name,phone:s.phone,email:s.email,admin:s.isadmin,verified:s.isverified}),h(!0)},M=async s=>{K({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const a=r.loading("Please Wait..."),v=localStorage.getItem("token"),P=await fetch("/api/removeuser",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({id:s})}),W=await P.json();P.ok&&(r.update(a,{render:"Deleted Successfully",type:"success",isLoading:!1,autoClose:1600}),c())}catch(a){r.update(id,{render:"Someting went wrong",type:"warn",isLoading:!1,autoClose:1600}),console.log(a)}})},O=s=>{C(s.target.value),b(1)},V=s=>{b(s)},z=s=>{p(s.target.value)};let j=f*u;const T=j-u,I=t.slice(T,j);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"allusers admin",children:[e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"All Users List"}),e.jsxs("span",{children:["Record :  ",e.jsxs("select",{name:"",id:"",value:u,onChange:O,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsx("span",{children:e.jsx("input",{type:"text",onChange:z,value:w,placeholder:"Type to search..."})})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Name "}),e.jsx("span",{children:"Phone"}),e.jsx("span",{children:"Email"}),e.jsxs("span",{children:[e.jsx(_,{style:{fontSize:"22px"}})," "]}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:"Date"})]}),e.jsx("div",{className:"body",id:"tablecontent",children:I&&I.map((s,n)=>{const a=new Date(s.createdAt),v=`${a.getUTCDate().toString().padStart(2,"0")} ${a.toLocaleString("default",{month:"short"})}, ${a.getFullYear().toString().substr(-2)}`;return e.jsxs("div",{children:[e.jsx("span",{children:n+1}),e.jsx("span",{children:s.name}),e.jsx("span",{children:s.phone}),e.jsx("span",{children:s.email}),e.jsx("span",{className:s.isverified?"status done":"status",children:s.isverified?"Yes":"No"}),e.jsxs("span",{children:[e.jsx(H,{className:"editicon ico",title:"Edit",onClick:()=>R(s)}),e.jsx(J,{className:"deleteicon ico",title:"Delete",onClick:()=>M(s._id)})]}),e.jsx("span",{children:v||""})]},n)})})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",T+1," To ",j>=t.length?j=t.length:j," of  ",t.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(G,{currentpage:f,changepageno:V,totalpost:t.length,postperpage:u})]})]}),e.jsx(Q,{handler:L,inp:g,setinp:x,modal:m,setmodal:h,fetche:c})]})})};export{Z as default};
