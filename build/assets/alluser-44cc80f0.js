import{a as F,u as R,j as e,T as k,F as P,I as A,S as L,M as y,B as E,f as Y,d as J,s as D,Q as r,b as G,i as K,r as o,P as Q,g as W}from"./index-f17b3dcd.js";const H=({inp:t,modal:S,setmodal:d,handler:l,fetche:w})=>{F(i=>i.userexplist);const p=R(),c=async i=>{const C=localStorage.getItem("token");p(D(!0));const{id:f,name:x,phone:g,email:v,admin:u,verified:N}=t;console.log(t);try{const m=await fetch("/api/adminuserupdate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({id:f,name:x,phone:g,email:v,admin:u,verified:N})}),h=await m.json();m.ok?(r.success(h.message,{autoClose:1300}),w(),d(!1)):(r.warn(h.message,{autoClose:1300}),console.log(h)),p(D(!1))}catch(m){r.warn("Sopmething went wrong",{autoClose:1300}),console.log(m),p(D(!1))}};return document.querySelector(".modal"),e.jsx("div",{className:"modal",style:{display:S?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"User Detail"}),e.jsxs("span",{className:"wrapper",children:[e.jsx(k,{sx:{width:"90%",mt:3,mb:1},id:"outlined-basic",label:"Name",name:"name",value:t.name,type:"text",onChange:l,variant:"outlined"}),e.jsx(k,{sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Phone",name:"phone",onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},type:"tel",value:t.phone,onChange:l,variant:"outlined"}),e.jsx(k,{disabled:!0,sx:{width:"90%",mt:1,mb:1},id:"outlined-basic",label:"Email",name:"email",value:t.email,type:"text",onChange:l,variant:"outlined"}),e.jsxs(P,{className:"caps",sx:{width:"90%",mt:1,mb:1},children:[e.jsx(A,{id:"demo-simple-select-label",children:"Type"}),e.jsxs(L,{name:"admin",labelId:"demo-simple-select-label",onChange:l,value:t.admin,id:"demo-simple-select",label:"Type",children:[e.jsx(y,{className:"caps",value:!1,children:"User"}),e.jsx(y,{className:"caps",value:!0,children:"Admin"})]})]}),t.verified,e.jsxs(P,{className:"caps",sx:{width:"90%",mt:1,mb:2},children:[e.jsx(A,{id:"demo-simple-select-label",children:"Verified"}),e.jsxs(L,{name:"verified",labelId:"demo-simple-select-label",onChange:l,value:t.verified,id:"demo-simple-select",label:"verified",children:[e.jsx(y,{className:"caps",value:!0,children:"Verified"}),e.jsx(y,{className:"caps",value:!1,children:"Unverified"})]})]}),e.jsxs("div",{className:"btn",children:[e.jsx(E,{className:"muibtn",onClick:c,variant:"contained",startIcon:e.jsx(Y,{}),children:"Submit"}),e.jsx(E,{onClick:()=>d(!1),className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(J,{}),children:"Cancel"})]})]})]})})};var T={},X=K;Object.defineProperty(T,"__esModule",{value:!0});var U=T.default=void 0,Z=X(G()),ee=e,se=(0,Z.default)((0,ee.jsx)("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z"}),"Verified");U=T.default=se;const ne=()=>{R(),F(s=>s.userexplist);const[t,S]=o.useState([]);o.useEffect(()=>{d()},[]);const d=async()=>{const s=localStorage.getItem("token");try{const n=await fetch("/api/adminuser",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),a=await n.json();n.ok?S(a.users):r.warn(a.message?a.message:"You are not authorised",{autoClose:1500})}catch(n){console.log(n)}},l=new Date,[w,p]=o.useState("");o.useState(!1);let c=l.getMonth()+1,i=l.getUTCDate();c<10&&(c="0"+c),i<10&&(i="0"+i),l.getFullYear()+""+c+i;const C={id:"",name:"",phone:"",email:"",admin:"",verified:""},[f,x]=o.useState(C),[g,v]=o.useState(1),[u,N]=o.useState(10),[m,h]=o.useState(!1),q=s=>{let n=s.target.name,a=s.target.value;console.log(n," : ",a),x({...f,[n]:a})},O=async s=>{x({id:s._id,name:s.name,phone:s.phone,email:s.email,admin:s.isadmin,verified:s.isverified}),h(!0)},z=async s=>{W({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const a=r.loading("Please Wait..."),b=localStorage.getItem("token"),$=await fetch("/api/removeuser",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({id:s})}),te=await $.json();$.ok&&(r.update(a,{render:"Deleted Successfully",type:"success",isLoading:!1,autoClose:1600}),d())}catch(a){r.update(id,{render:"Someting went wrong",type:"warn",isLoading:!1,autoClose:1600}),console.log(a)}})},B=s=>{N(s.target.value),v(1)},M=s=>{v(s)},V=s=>{p(s.target.value)};let j=g*u;const I=j-u,_=t.slice(I,j);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"allusers admin",children:[e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"All Users List"}),e.jsxs("span",{children:["Record :  ",e.jsxs("select",{name:"",id:"",value:u,onChange:B,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsx("span",{children:e.jsx("input",{type:"text",onChange:V,value:w,placeholder:"Type to search..."})})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Name "}),e.jsx("span",{children:"Phone"}),e.jsx("span",{children:"Email"}),e.jsxs("span",{children:[e.jsx(U,{})," "]}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:"Date"})]}),e.jsx("div",{className:"body",id:"tablecontent",children:_&&_.map((s,n)=>{const a=new Date(s.createdAt),b=`${a.getUTCDate().toString().padStart(2,"0")} ${a.toLocaleString("default",{month:"short"})}, ${a.getFullYear().toString().substr(-2)}`;return e.jsxs("div",{children:[e.jsx("span",{children:n+1}),e.jsx("span",{children:s.name}),e.jsx("span",{children:s.phone}),e.jsx("span",{children:s.email}),e.jsx("span",{className:s.isverified?"status done":"status",children:s.isverified?"Yes":"No"}),e.jsxs("span",{children:[e.jsx("i",{title:"Edit",onClick:()=>O(s),className:"fa fa-pencil-square-o","aria-hidden":"true"}),e.jsx("i",{title:"Delete",onClick:()=>z(s._id),className:"fa fa-trash-o","aria-hidden":"true"})]}),e.jsx("span",{children:b||""})]},n)})})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",I+1," To ",j>=t.length?j=t.length:j," of  ",t.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(Q,{currentpage:g,changepageno:M,totalpost:t.length,postperpage:u})]})]}),e.jsx(H,{handler:q,inp:f,setinp:x,modal:m,setmodal:h,fetche:d})]})})};export{ne as default};
