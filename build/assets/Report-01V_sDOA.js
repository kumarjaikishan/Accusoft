var P=Object.defineProperty;var U=(t,e,r)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var x=(t,e,r)=>U(t,typeof e!="symbol"?e+"":e,r);import{R as D,j as n,f as _,c as $,r as m,d as f,k as B,m as V,F as W,i as z,S as H,B as v,l as q,n as J}from"./index-B9NyKQW9.js";import{V as K}from"./index-FppGNBod.js";import{M as F}from"./MenuItem-C0bljZWw.js";var O={exports:{}},G="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Q=G,X=Q;function T(){}function E(){}E.resetWarningCache=T;var Z=function(){function t(s,a,o,l,d,c){if(c!==X){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:E,resetWarningCache:T};return r.PropTypes=r,r};O.exports=Z();var p=O.exports;const ee=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),I=t=>Array.isArray(t)&&t.every(e=>typeof e=="object"&&!(e instanceof Array)),te=t=>Array.isArray(t)&&t.every(e=>Array.isArray(e)),ne=t=>Array.from(t.map(e=>Object.keys(e)).reduce((e,r)=>new Set([...e,...r]),[])),re=(t,e)=>{e=e||ne(t);let r=e,s=e;I(e)&&(r=e.map(o=>o.label),s=e.map(o=>o.key));const a=t.map(o=>s.map(l=>se(l,o)));return[r,...a]},se=(t,e)=>{const r=t.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(s,a,o,l){const d=s[a];if(d==null)l.splice(1);else return d},e);return r===void 0?t in e?e[t]:"":r},ae=t=>typeof t>"u"||t===null?"":t,A=(t,e=",",r='"')=>t.filter(s=>s).map(s=>s.map(a=>ae(a)).map(a=>`${r}${a}${r}`).join(e)).join(`
`),oe=(t,e,r,s)=>A(e?[e,...t]:t,r,s),ie=(t,e,r,s)=>A(re(t,e),r,s),ce=(t,e,r,s)=>e?`${e.join(r)}
${t}`:t.replace(/"/g,'""'),L=(t,e,r,s)=>{if(I(t))return ie(t,e,r,s);if(te(t))return oe(t,e,r,s);if(typeof t=="string")return ce(t,e,r);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},M=(t,e,r,s,a)=>{const o=L(t,r,s,a),l=ee()?"application/csv":"text/csv",d=new Blob([e?"\uFEFF":"",o],{type:l}),c=`data:${l};charset=utf-8,${e?"\uFEFF":""}${o}`,u=window.URL||window.webkitURL;return typeof u.createObjectURL>"u"?c:u.createObjectURL(d)},Y={data:p.oneOfType([p.string,p.array,p.func]).isRequired,headers:p.array,target:p.string,separator:p.string,filename:p.string,uFEFF:p.bool,onClick:p.func,asyncOnClick:p.bool,enclosingCharacter:p.string},N={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},le={target:"_blank"};class w extends D.Component{constructor(e){super(e),this.state={}}buildURI(){return M(...arguments)}componentDidMount(){const{data:e,headers:r,separator:s,enclosingCharacter:a,uFEFF:o,target:l,specs:d,replace:c}=this.props;this.state.page=window.open(this.buildURI(e,o,r,s,a),l,d,c)}getWindow(){return this.state.page}render(){return null}}x(w,"defaultProps",Object.assign(N,le)),x(w,"propTypes",Y);var C;let de=(C=class extends D.Component{constructor(e){super(e),this.buildURI=this.buildURI.bind(this)}buildURI(){return M(...arguments)}handleLegacy(e,r=!1){if(window.navigator.msSaveOrOpenBlob){e.preventDefault();const{data:s,headers:a,separator:o,filename:l,enclosingCharacter:d,uFEFF:c}=this.props,u=r&&typeof s=="function"?s():s;let y=new Blob([c?"\uFEFF":"",L(u,a,o,d)]);return window.navigator.msSaveBlob(y,l),!1}}handleAsyncClick(e){const r=s=>{if(s===!1){e.preventDefault();return}this.handleLegacy(e,!0)};this.props.onClick(e,r)}handleSyncClick(e){if(this.props.onClick(e)===!1){e.preventDefault();return}this.handleLegacy(e)}handleClick(){return e=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(e):this.handleSyncClick(e);this.handleLegacy(e)}}render(){const{data:e,headers:r,separator:s,filename:a,uFEFF:o,children:l,onClick:d,asyncOnClick:c,enclosingCharacter:u,...y}=this.props,g=typeof window>"u"?"":this.buildURI(e,o,r,s,u);return n.jsx("a",{download:a,...y,ref:k=>this.link=k,target:"_self",href:g,onClick:this.handleClick(),children:l})}},x(C,"defaultProps",N),x(C,"propTypes",Y),C);const pe=de,xe=()=>{const t=_(),{user:e,explist:r,ledgerlist:s}=$(i=>i.userexplist),[a,o]=m.useState({from:f().subtract(1,"month").format("YYYY-MM-DD"),to:f().format("YYYY-MM-DD"),ledger:"all"}),l=m.useMemo(()=>[{label:"Ledger",key:"ledger.ledger"},{label:"Amount",key:"amount"},{label:"Date",key:"date"},{label:"Narration",key:"narration"}],[]),d=m.useCallback(i=>{const{name:h,value:j}=i.target;o(b=>({...b,[h]:j}))},[]),c=m.useMemo(()=>{const{from:i,to:h,ledger:j}=a;return r.filter(b=>{const S=f(b.date).isBetween(f(i).startOf("day"),f(h).endOf("day"),null,"[]");return j==="all"?S:S&&b.ledger.ledger===j})},[r,a.from,a.to,a.ledger]),u=c.length>0,y=m.useCallback(()=>{o({from:f().subtract(1,"month").format("YYYY-MM-DD"),to:f().format("YYYY-MM-DD"),ledger:"all"})},[]),R=m.useCallback(()=>{t(B(!0)),setTimeout(()=>window.print(),1)},[t]),g=m.useCallback(i=>f(i).format("DD-MMM-YY"),[]),k=m.useMemo(()=>c.reduce((i,h)=>i+h.amount,0),[c]);return n.jsxs(V.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"-100%"},transition:{duration:.2,ease:"easeInOut"},className:"report",children:[n.jsxs("div",{className:"cont",children:[n.jsxs("span",{children:[n.jsxs("span",{children:["From:",n.jsx("input",{type:"date",name:"from",value:a.from,onChange:d})]}),n.jsxs("span",{children:["To:",n.jsx("input",{type:"date",name:"to",value:a.to,onChange:d})]}),n.jsxs(W,{className:"ledger caps mui",size:"small",children:[n.jsx(z,{children:"Ledger"}),n.jsxs(H,{name:"ledger",label:"Ledger",value:a.ledger,onChange:d,children:[n.jsx(F,{value:"all",children:"All"}),s.map(i=>n.jsx(F,{value:i.ledger,children:i.ledger},i._id))]})]}),n.jsx(v,{className:"muibtn",disabled:!u,variant:"contained",onClick:y,startIcon:n.jsx(K,{}),children:"Clear"})]}),n.jsxs("span",{children:[n.jsx(pe,{data:c,headers:l,filename:`${e==null?void 0:e.name}-Expense-Record`,children:n.jsx(v,{className:"muibtn",size:"small",variant:"contained",startIcon:n.jsx(q,{}),children:"CSV"})}),n.jsx(v,{className:"muibtn",size:"small",variant:"contained",onClick:R,startIcon:n.jsx(J,{}),children:"Print"})]})]}),n.jsxs("div",{className:"table",id:"printarea",children:[n.jsxs("div",{className:"head",children:[n.jsxs("b",{children:["Accusoft - ",e==null?void 0:e.name]}),"(Report from ",g(a.from)," to ",g(a.to),")"]}),n.jsxs("table",{id:"tavlecontent",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"S.no"}),n.jsx("th",{children:"Ledger"}),n.jsx("th",{children:"Amount"}),n.jsx("th",{children:"Narration"}),n.jsx("th",{children:"Date"})]})}),n.jsxs("tbody",{children:[c.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:5,children:n.jsx("b",{children:"No Record Found"})})}):c.map((i,h)=>n.jsxs("tr",{children:[n.jsx("td",{children:h+1}),n.jsx("td",{children:i.ledger.ledger}),n.jsx("td",{children:i.amount}),n.jsx("td",{children:i.narration}),n.jsx("td",{children:g(i.date)})]},i._id||h)),c.length>0&&n.jsxs("tr",{children:[n.jsx("td",{colSpan:2,children:n.jsx("b",{children:"Total"})}),n.jsx("td",{children:n.jsx("b",{children:k})}),n.jsx("td",{colSpan:2})]})]})]})]})]})};export{xe as default};
