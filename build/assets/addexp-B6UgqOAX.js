import{r as C,j as e,v as ve,w as be,c as K,f as W,o as R,F as ye,i as Ce,S as Se,T as U,x as $e,B as P,M as ke,I as we,Q as I,y as E,h as Z,z as De,A as te,s as se,e as ne,g as ae,G as Ne,R as H,b as Me,d as F,C as Ie,m as _,D as Oe,E as Ae,H as Le}from"./index-TeJbZjp_.js";import{V as Pe}from"./index-D1-IV9QH.js";import{M as Te}from"./MenuItem-BLKYQoxq.js";import{H as ie,R as re,a as ze}from"./index-Dr9t-MVW.js";const Ee=({totalpost:D,postperpage:w,changepageno:S,currentpage:v})=>{let f=[];const[y,p]=C.useState(5),[x,i]=C.useState(5),[c,g]=C.useState(0);for(let n=1;n<=Math.ceil(D/w);n++)f.push(n);const N=f.map((n,t)=>{if(n<x+1&&n>c)return e.jsx("span",{onClick:()=>S(n),className:v==n?"pages active":"pages",children:n},t)}),l=()=>{i(x+y),g(c+y),x>=f.length-1&&(i(f.length),g(f.length-y))},d=()=>{i(x-y),g(c-y),c<=1&&(i(y),g(0))};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{title:"Previous 5 Pages",onClick:d}),N,e.jsx(be,{title:"Next 5 Pages",onClick:l})]})},Ye=({modal:D,navigate:w,disable:S,handlechange:v,fields:f,isupdate:y,sub:p,setmodal:x,setisupdate:i,reset:c})=>{var j;const g=K(r=>r.userexplist),N=W(),{request:l,loading:d}=R();C.useEffect(()=>{},[d]);const n=async r=>{let{ledger:m,date:a,amount:u,narration:b}=f;try{const $=await l({url:"updateexp",method:"POST",body:{_id:r,ledger:m,date:a,amount:u,narration:t(b)}});I.success($==null?void 0:$.message,{autoClose:1300}),N(E()),c(),i(!1),x(!1)}catch{}},t=r=>r.split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1).toLowerCase()).join(" ");var o=document.querySelector(".modal");const h=function(r){r.target==o&&x(!1)};return e.jsx("div",{className:"modal",onClick:h,style:{display:D?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsx("h1",{children:"Add Voucher"}),e.jsxs("span",{className:"wrapper",children:[e.jsxs(ye,{className:"caps",sx:{width:"90%",mt:2,mb:2},children:[e.jsx(Ce,{id:"demo-simple-select-label",children:"Ledger"}),e.jsx(Se,{name:"ledger",labelId:"demo-simple-select-label",onChange:v,value:f.ledger,id:"demo-simple-select",label:"Ledger",children:(j=g==null?void 0:g.ledgerlist)==null?void 0:j.map((r,m)=>e.jsx(Te,{sx:{textTransform:"capitalize"},value:r._id,children:r.ledger},m))})]}),e.jsx(U,{type:"date",label:"Date",value:f.date,name:"date",onChange:v,sx:{width:"90%",mt:2,mb:2}}),e.jsx(U,{sx:{width:"90%",mt:2,mb:2},id:"outlined-basic",label:"Amount",name:"amount",onKeyPress:r=>{/[0-9]/.test(r.key)||r.preventDefault()},type:"tel",value:f.amount,onChange:v,InputProps:{startAdornment:e.jsx($e,{position:"start",children:"â‚¹"})},variant:"outlined"}),e.jsx(U,{multiline:!0,rows:2,sx:{width:"90%",mt:2,mb:2},id:"outlined-basic",label:"Narration",name:"narration",value:f.narration,type:"text",onChange:v,variant:"outlined"}),e.jsxs("div",{className:"btn",children:[y?e.jsx(P,{onClick:()=>n(f._id),variant:"contained",startIcon:e.jsx(ke,{}),children:"Update"}):e.jsx(P,{disabled:S,onClick:p,variant:"contained",startIcon:e.jsx(we,{}),children:"Submit"}),e.jsx(P,{onClick:()=>{x(!1),i(!1),c()},className:"muibtn outlined",title:"Cancel",variant:"outlined",startIcon:e.jsx(Pe,{}),children:"Cancel"})]})]})]})})},Ue=({setmodal:D,setdisable:w,isledupdate:S,setisledupdate:v})=>{var m;const f=W(),y=K(a=>a.userexplist),[p,x]=C.useState(!1);C.useEffect(()=>{},[]);const i={ind:"",ledger:"",budget:""},[c,g]=C.useState(i),N=a=>{g({...c,ledger:a.target.value})},l=a=>{const u=a.target.value;isNaN(u)||g({...c,budget:u})},{request:d,loading:n}=R();C.useEffect(()=>{f(Z(n))},[n]);const t=async()=>{if(!c.ledger)return I.warn("Ledger Can't be Blank",{autoClose:1300});if(!c.budget)return I.warn("Budget Can't be Blank",{autoClose:1300});try{const a=await d({url:"addledger",method:"POST",body:{ledger:c.ledger,budget:parseFloat(c.budget)}});I.success(a.message,{autoClose:1300}),f(E()),g(i),w(!1)}catch{w(!1)}},o=async()=>{if(!c.ledger)return I.warn("Ledger Can't be Blank",{autoClose:1300});const a=c.ind,u=c.ledger,b=parseFloat(c.budget);localStorage.getItem("token"),w(!0);try{const $=await d({url:"updateledger",method:"POST",body:{ledger_id:a,newledger:u,newbudget:b}});I.success($.message,{autoClose:1300}),g(i),x(!1),f(E())}catch{}finally{w(!1)}},h=async a=>{se({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async u=>{if(u){w(!0);try{const b=await d({url:"deleteledger",method:"POST",body:{ledgerid:a}});I.success(b.message,{autoClose:1300}),f(E())}catch{}finally{w(!1)}}})},j=(a,u,b)=>{g({ind:a,ledger:u,budget:b}),x(!0)},r=a=>{a.target.classList.contains("ledpage")&&v(!1)};return e.jsx("div",{className:"ledpage",onClick:r,style:{display:S?"block":"none"},children:e.jsxs("div",{className:"box",children:[e.jsxs("h2",{children:["Hi, ",(m=y==null?void 0:y.user)==null?void 0:m.name]}),e.jsxs("span",{className:"ledwrapper",children:[e.jsxs("div",{className:"cont",children:[e.jsx(U,{label:"Enter Ledger",size:"small",variant:"outlined",style:{width:"250px"},value:c.ledger,onChange:N,className:"inpe"}),e.jsx(U,{label:"Budget",size:"small",variant:"outlined",value:c.budget,style:{width:"170px"},onChange:l,className:"inpe",type:"number"}),p?e.jsx(P,{size:"small",className:"btne",disabled:n,title:"Add",onClick:o,startIcon:e.jsx(De,{}),variant:"contained",children:"Update"}):e.jsx(P,{size:"small",className:"btne",disabled:n,title:"Add",onClick:t,startIcon:e.jsx(te,{}),variant:"contained",children:"Add"})]}),e.jsx("div",{className:"mater",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ledger"}),e.jsx("th",{children:"Budget"}),e.jsx("th",{children:"Edit"}),e.jsx("th",{children:"Delete"})]})}),e.jsx("tbody",{children:y.ledgerlist&&y.ledgerlist.map((a,u)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.ledger}),e.jsx("td",{children:a.budget}),e.jsx("td",{children:e.jsx(ie,{className:"editicon ico",title:"Edit",onClick:()=>j(a._id,a.ledger,a.budget)})}),e.jsx("td",{children:e.jsx(re,{className:"deleteicon ico",title:"Delete",onClick:()=>h(a._id)})})]},u))})]})})]})]})})};var oe={exports:{}};(function(D,w){(function(S,v){D.exports=v()})(ne,function(){var S="minute",v=/[+-]\d\d(?::?\d\d)?/g,f=/([+-]|\d\d)/g;return function(y,p,x){var i=p.prototype;x.utc=function(t){var o={date:t,utc:!0,args:arguments};return new p(o)},i.utc=function(t){var o=x(this.toDate(),{locale:this.$L,utc:!0});return t?o.add(this.utcOffset(),S):o},i.local=function(){return x(this.toDate(),{locale:this.$L,utc:!1})};var c=i.parse;i.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),c.call(this,t)};var g=i.init;i.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else g.call(this)};var N=i.utcOffset;i.utcOffset=function(t,o){var h=this.$utils().u;if(h(t))return this.$u?0:h(this.$offset)?N.call(this):this.$offset;if(typeof t=="string"&&(t=function(a){a===void 0&&(a="");var u=a.match(v);if(!u)return null;var b=(""+u[0]).match(f)||["-",0,0],$=b[0],O=60*+b[1]+ +b[2];return O===0?0:$==="+"?O:-O}(t),t===null))return this;var j=Math.abs(t)<=16?60*t:t;if(j===0)return this.utc(o);var r=this.clone();if(o)return r.$offset=j,r.$u=!1,r;var m=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(r=this.local().add(j+m,S)).$offset=j,r.$x.$localOffset=m,r};var l=i.format;i.format=function(t){var o=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,o)},i.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var d=i.toDate;i.toDate=function(t){return t==="s"&&this.$offset?x(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var n=i.diff;i.diff=function(t,o,h){if(t&&this.$u===t.$u)return n.call(this,t,o,h);var j=this.local(),r=x(t).local();return n.call(j,r,o,h)}}})})(oe);var Fe=oe.exports;const Re=ae(Fe);var le={exports:{}};(function(D,w){(function(S,v){D.exports=v()})(ne,function(){var S={year:0,month:1,day:2,hour:3,minute:4,second:5},v={};return function(f,y,p){var x,i=function(l,d,n){n===void 0&&(n={});var t=new Date(l),o=function(h,j){j===void 0&&(j={});var r=j.timeZoneName||"short",m=h+"|"+r,a=v[m];return a||(a=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:h,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:r}),v[m]=a),a}(d,n);return o.formatToParts(t)},c=function(l,d){for(var n=i(l,d),t=[],o=0;o<n.length;o+=1){var h=n[o],j=h.type,r=h.value,m=S[j];m>=0&&(t[m]=parseInt(r,10))}var a=t[3],u=a===24?0:a,b=t[0]+"-"+t[1]+"-"+t[2]+" "+u+":"+t[4]+":"+t[5]+":000",$=+l;return(p.utc(b).valueOf()-($-=$%1e3))/6e4},g=y.prototype;g.tz=function(l,d){l===void 0&&(l=x);var n,t=this.utcOffset(),o=this.toDate(),h=o.toLocaleString("en-US",{timeZone:l}),j=Math.round((o-new Date(h))/1e3/60),r=15*-Math.round(o.getTimezoneOffset()/15)-j;if(!Number(r))n=this.utcOffset(0,d);else if(n=p(h,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(r,!0),d){var m=n.utcOffset();n=n.add(t-m,"minute")}return n.$x.$timezone=l,n},g.offsetName=function(l){var d=this.$x.$timezone||p.tz.guess(),n=i(this.valueOf(),d,{timeZoneName:l}).find(function(t){return t.type.toLowerCase()==="timezonename"});return n&&n.value};var N=g.startOf;g.startOf=function(l,d){if(!this.$x||!this.$x.$timezone)return N.call(this,l,d);var n=p(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return N.call(n,l,d).tz(this.$x.$timezone,!0)},p.tz=function(l,d,n){var t=n&&d,o=n||d||x,h=c(+p(),o);if(typeof l!="string")return p(l).tz(o);var j=function(u,b,$){var O=u-60*b*1e3,A=c(O,$);if(b===A)return[O,b];var Y=c(O-=60*(A-b)*1e3,$);return A===Y?[O,A]:[u-60*Math.min(A,Y)*1e3,Math.max(A,Y)]}(p.utc(l,t).valueOf(),h,o),r=j[0],m=j[1],a=p(r).utcOffset(m);return a.$x.$timezone=o,a},p.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},p.tz.setDefault=function(l){x=l}}})})(le);var qe=le.exports;const Be=ae(qe);function He(D){return Ne({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"},child:[]}]})(D)}F.extend(Re);F.extend(Be);const _e=D=>D.split(" ").map(S=>S.charAt(0).toUpperCase()+S.slice(1).toLowerCase()).join(" "),Ge=()=>{const D=H.useRef(0);D.current++;const w=W();let S=Me();const v=K(s=>s.userexplist.explist),[f,y]=C.useState(""),[p,x]=C.useState(""),i=H.useRef(!1),[c,g]=C.useState(!1),[N,l]=C.useState(!1),[d,n]=C.useState(!1),[t,o]=C.useState(1),[h,j]=C.useState(10),[r,m]=C.useState(!1),[a,u]=C.useState(!1),b={_id:"",ledger:"",date:F().format("YYYY-MM-DD"),amount:"",narration:""},{fields:$,handlechange:O,reset:A,editfields:Y}=Ie(b),{request:ce,loading:q}=R(),{request:de,loading:V}=R();C.useEffect(()=>{w(Z(q||V))},[q,V]),C.useEffect(()=>{if(u(!0),f===""){x(""),u(!1);return}const s=setTimeout(()=>{x(f.toLowerCase()),u(!1)},1200);return()=>clearTimeout(s)},[f]);const ue=async()=>{let{ledger:s,date:k,amount:M,narration:T}=$;if(!s||!k||!M||!T){const ee=document.querySelector(".box");return ee.classList.add("shake"),setTimeout(()=>ee.classList.remove("shake"),420),w(Z(!1)),I.warn("Kindly Fill all Fields",{autoClose:1700})}const z=await ce({url:"addexpense",method:"POST",body:{ledger:s,date:k,amount:M,narration:_e(T)}});I.success(z==null?void 0:z.message,{autoClose:1300}),w(E()),m(!1),A()},he=s=>{const k={_id:s._id,ledger:s.ledger._id,date:F(s.date).format("YYYY-MM-DD"),amount:s.amount,narration:s.narration};Y(k),g(!0),m(!0)},me=s=>{i.current=!0,G([s])},fe=()=>{const s=document.querySelectorAll("#tablecontent input:checked"),k=Array.from(s).map(M=>M.id);G(k)},G=async s=>{if(s.length<1)return I.warn("Kindly Select Atlest 1 Entry",{autoClose:1700});se({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Data!",icon:"warning",buttons:!0,dangerMode:!0}).then(async k=>{if(k){const M=await de({url:"delmany",method:"POST",body:{id:s}});I.success(M==null?void 0:M.message,{autoClose:1800}),w(E()),document.querySelectorAll("#tablecontent input:checked").forEach(T=>T.checked=!1),setTimeout(()=>{i.current=!1},100),B()}})},pe=()=>{const s=document.querySelector("#allcheck");document.querySelectorAll("#tablecontent input").forEach(M=>M.checked=s.checked),B()},xe=s=>{j(Number(s.target.value)),o(1)},ge=s=>{o(s)},B=()=>{const s=document.querySelectorAll("#tablecontent input"),k=document.querySelectorAll("#tablecontent div");s.forEach((M,T)=>{const z=k[T];M.checked?z.classList.add("checked"):z.classList.remove("checked")})},L=H.useMemo(()=>(v==null?void 0:v.filter(s=>p===""||s.narration.toLowerCase().includes(p)||s.ledger.ledger.toLowerCase().includes(p)||s.amount.toString().includes(p)))||[],[v,p]),{currentPosts:Q,firstPostIndex:J,lastPostIndex:X}=C.useMemo(()=>{const s=t*h,k=s-h;return{firstPostIndex:k,lastPostIndex:s,currentPosts:L.slice(k,s)}},[L,t,h]),je={visible:{transition:{delayChildren:.1}}};return e.jsx(e.Fragment,{children:e.jsxs(_.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"-100%"},transition:{duration:.2,ease:"easeInOut"},className:r||d?"exp ismodal":"exp",children:[e.jsxs("div",{className:"add",children:[e.jsx(P,{title:"Add Expense",onClick:()=>m(!0),startIcon:e.jsx(te,{}),variant:"contained",children:"Add Expense"}),e.jsx(P,{title:"Ledger",onClick:()=>n(!0),startIcon:e.jsx(Oe,{}),variant:"outlined",children:"Ledger"})]}),e.jsxs("div",{className:"head",children:[e.jsx("span",{children:"Expense List "}),e.jsxs("span",{children:["Record :"," ",e.jsxs("select",{title:"Items Per Page",value:h,onChange:xe,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsx("option",{value:"500",children:"500"})]})]}),e.jsxs("span",{children:[e.jsx("input",{type:"text",title:"Search",onChange:s=>y(s.target.value),value:f,placeholder:"Type to search..."}),a?e.jsxs("span",{title:"Searching",children:["  ",e.jsx(He,{className:"spin"})," "]}):e.jsxs("span",{title:"clear",onClick:()=>y(""),children:["   ",e.jsx(Ae,{})]})]})]}),e.jsxs("div",{className:"table",children:[e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"S.no"}),e.jsx("span",{children:"Ledger"}),e.jsx("span",{children:"Amt. "}),e.jsx("span",{children:"Narration"}),e.jsx("span",{children:"Date "}),e.jsx("span",{children:"Action"}),e.jsx("span",{children:e.jsx("input",{type:"checkbox",onClick:pe,id:"allcheck"})})]}),e.jsxs(_.div,{variants:je,initial:"hidden",animate:"visible",className:"body",id:"tablecontent",children:[L.length<1&&e.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"center",margin:"8px 0"},children:e.jsx("b",{children:"No Expense Added"})}),e.jsxs(Le,{children:[Q.map((s,k)=>e.jsxs(_.div,{exit:i.current?{opacity:1,x:"-102%",transition:{duration:.6}}:{},children:[e.jsx("span",{children:J+k+1}),e.jsx("span",{className:"caps",children:s.ledger.ledger}),e.jsx("span",{children:s.amount}),e.jsx("span",{children:s.narration}),e.jsx("span",{children:F(s.date).format("DD MMM, YYYY")}),e.jsxs("span",{children:[e.jsx(ie,{title:"Edit",onClick:()=>he(s),className:"editicon ico"}),e.jsx(re,{title:"Delete",onClick:()=>me(s._id),className:"deleteicon ico"})]}),e.jsx("span",{children:e.jsx("input",{type:"checkbox",title:"select",onClick:B,id:s._id})})]},s._id)),e.jsxs("div",{id:"foot",children:[e.jsx("span",{}),e.jsx("span",{style:{fontWeight:700},children:"Total"}),e.jsx("span",{style:{fontWeight:700},id:"totalhere",children:Q.reduce((s,k)=>s+k.amount,0)}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{colSpan:"1",id:"alldelete",title:"Delete Selected Item",children:e.jsx(ze,{onClick:fe})}),e.jsx("span",{})]})]})]})]}),e.jsxs("div",{className:"foot",children:[e.jsxs("span",{children:["Showing Result From ",L.length===0?0:J+1," To"," ",X>=L.length?L.length:X," of"," ",L.length," Results"]}),e.jsxs("span",{children:["Pages :",e.jsx(Ee,{currentpage:t,changepageno:ge,totalpost:L.length,postperpage:h})]})]}),e.jsx(Ye,{init:b,setdisable:l,disable:q,reset:A,setisupdate:g,setmodal:m,sub:ue,modal:r,handlechange:O,fields:$,isupdate:c,navigate:S}),e.jsx(Ue,{navigate:S,setmodal:m,setdisable:l,disable:N,setisledupdate:n,isledupdate:d})]})})};export{Ge as default};
